# Gear Freak í”„ë¡œì íŠ¸ Cursor Rules

## Presentation Layer êµ¬ì¡° ê·œì¹™

í”„ë¡œì íŠ¸ì˜ Presentation LayerëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤:

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
presentation/
â”œâ”€â”€ screen/          # Screen (ë¼ìš°íŒ… ë‹¨ìœ„)
â”œâ”€â”€ view/            # View (ìƒíƒœë³„ UI: LoadingView, DataView, ErrorView)
â”œâ”€â”€ component/       # Component (ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ìœ„ì ¯, ì—¬ëŸ¬ featureì—ì„œ ì‚¬ìš© ê°€ëŠ¥)
â”œâ”€â”€ widget/          # Widget (íŠ¹ì • í™”ë©´ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ì‘ì€ ë‹¨ìœ„)
â”œâ”€â”€ provider/        # Provider/Notifier (ìƒíƒœ ê´€ë¦¬)
â””â”€â”€ utils/           # Utils (ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜)
```

### êµ¬ë¶„ ê¸°ì¤€

- **Screen**: ë¼ìš°íŒ…ì´ ë˜ëŠ” í™”ë©´ ë‹¨ìœ„ (Route)
- **View**: ë„¤íŠ¸ì›Œí¬ ìƒíƒœì— ë”°ë¥¸ ì¸í„°í˜ì´ìŠ¤ (error, loading, data ìƒíƒœë³„ UI)
- **Component**: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë…ë¦½ì ì¸ UI ì»´í¬ë„ŒíŠ¸ (ì—¬ëŸ¬ featureì—ì„œ ì‚¬ìš© ê°€ëŠ¥)
- **Widget**: íŠ¹ì • í™”ë©´ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ì‘ì€ ë‹¨ìœ„ ìœ„ì ¯

### Common í´ë” êµ¬ì¡°

```
common/
â”œâ”€â”€ component/       # ê³µí†µ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ gb_dialog.dart
â”‚   â”œâ”€â”€ gb_snackbar.dart
â”‚   â””â”€â”€ gb_text_form_field.dart
â”œâ”€â”€ view/            # ê³µí†µ ìƒíƒœë³„ UI
â”‚   â”œâ”€â”€ gb_error_view.dart
â”‚   â”œâ”€â”€ gb_empty_view.dart
â”‚   â””â”€â”€ gb_loading_view.dart
â””â”€â”€ ...
```

### ì˜ˆì‹œ

```dart
// Screen: ë¼ìš°íŒ… ë‹¨ìœ„
class ProductDetailScreen extends ConsumerStatefulWidget {
  @override
  Widget build(BuildContext context) {
    final state = ref.watch(productDetailNotifierProvider);
    return state.when(
      loading: () => ProductDetailLoadingView(),  // View
      data: (data) => ProductDetailView(model: data),  // View
      error: (error) => ProductDetailErrorView(...),  // View
    );
  }
}

// View: ìƒíƒœë³„ UI
class ProductDetailLoadingView extends StatelessWidget { ... }
class ProductDetailView extends StatelessWidget { ... }
class ProductDetailErrorView extends StatelessWidget { ... }

// Component: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ìœ„ì ¯
class ProductCardWidget extends StatelessWidget { ... }

// Widget: íŠ¹ì • í™”ë©´ì—ì„œë§Œ ì‚¬ìš©
class ProductBasicInfoSectionWidget extends StatelessWidget { ... }
```

## Dialog ì‚¬ìš© ê·œì¹™

- í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ë‹¤ì´ì–¼ë¡œê·¸ëŠ” `GbDialog`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- `AlertDialog`ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ë§ê³ , `GbDialog.show()`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
- `GbDialog`ëŠ” `lib/common/component/gb_dialog.dart`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš©
final shouldDelete = await GbDialog.show(
  context: context,
  title: 'ìƒí’ˆ ì‚­ì œ',
  content: 'ì •ë§ë¡œ ì´ ìƒí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
  confirmText: 'ì‚­ì œ',
  cancelText: 'ì·¨ì†Œ',
  confirmColor: Colors.red,
);

// âŒ ì˜ëª»ëœ ì‚¬ìš©
showDialog(
  context: context,
  builder: (context) => AlertDialog(...),
);
```

## SnackBar ì‚¬ìš© ê·œì¹™

- í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ìŠ¤ë‚µë°”ëŠ” `GbSnackBar`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- `ScaffoldMessenger.of(context).showSnackBar()`ì™€ `SnackBar`ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ë§ê³ , `GbSnackBar`ì˜ static ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
- `GbSnackBar`ëŠ” `lib/common/component/gb_snackbar.dart`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì„±ê³µ ë©”ì‹œì§€
GbSnackBar.showSuccess(context, 'ìƒí’ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤');

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì—ëŸ¬ ë©”ì‹œì§€
GbSnackBar.showError(context, 'ìƒí’ˆ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ê²½ê³  ë©”ì‹œì§€
GbSnackBar.showWarning(context, 'ìµœì†Œ 1ì¥ì˜ ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”');

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì •ë³´ ë©”ì‹œì§€
GbSnackBar.showInfo(context, 'ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 10ì¥ê¹Œì§€ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì»¤ìŠ¤í…€ íƒ€ì… ë° duration
GbSnackBar.show(
  context,
  'ë©”ì‹œì§€',
  type: GbSnackBarType.success,
  duration: const Duration(seconds: 3),
);

// âŒ ì˜ëª»ëœ ì‚¬ìš©
ScaffoldMessenger.of(context).showSnackBar(
  SnackBar(
    content: Text('ë©”ì‹œì§€'),
    backgroundColor: Colors.red,
  ),
);
```

### ìŠ¤ë‚µë°” íƒ€ì…

- `GbSnackBar.showSuccess()`: ì„±ê³µ ë©”ì‹œì§€ (ì´ˆë¡ìƒ‰, ì²´í¬ ì•„ì´ì½˜)
- `GbSnackBar.showError()`: ì—ëŸ¬ ë©”ì‹œì§€ (ë¹¨ê°„ìƒ‰, ì—ëŸ¬ ì•„ì´ì½˜, ê¸°ë³¸ 3ì´ˆ)
- `GbSnackBar.showWarning()`: ê²½ê³  ë©”ì‹œì§€ (ì£¼í™©ìƒ‰, ê²½ê³  ì•„ì´ì½˜)
- `GbSnackBar.showInfo()`: ì •ë³´ ë©”ì‹œì§€ (íŒŒë€ìƒ‰, ì •ë³´ ì•„ì´ì½˜)

## ErrorView ì‚¬ìš© ê·œì¹™

- í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì—ëŸ¬ ìƒíƒœ í‘œì‹œëŠ” `GbErrorView`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- ì—ëŸ¬ ì•„ì´ì½˜, ë©”ì‹œì§€, "ë‹¤ì‹œ ì‹œë„" ë²„íŠ¼ì„ ì§ì ‘ êµ¬ì„±í•˜ì§€ ë§ê³ , `GbErrorView` ìœ„ì ¯ì„ ì‚¬ìš©í•˜ì„¸ìš”.
- `GbErrorView`ëŠ” `lib/common/view/gb_error_view.dart`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ê¸°ë³¸ ì—ëŸ¬ ë·°
GbErrorView(
  message: 'ìƒí’ˆì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
  onRetry: () {
    ref.read(productNotifierProvider.notifier).loadProducts();
  },
)

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì œëª©ê³¼ ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ í¬í•¨
GbErrorView(
  title: 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤',
  message: 'ìƒí’ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤',
  onRetry: () {
    ref.read(productNotifierProvider.notifier).loadProduct(id);
  },
  showBackButton: true,
  onBack: () => context.pop(),
)

// âŒ ì˜ëª»ëœ ì‚¬ìš©
Center(
  child: Column(
    mainAxisAlignment: MainAxisAlignment.center,
    children: [
      Icon(Icons.error_outline, size: 64, color: Colors.red),
      Text('ì—ëŸ¬ ë©”ì‹œì§€'),
      ElevatedButton(
        onPressed: () {},
        child: Text('ë‹¤ì‹œ ì‹œë„'),
      ),
    ],
  ),
)
```

### GbErrorView íŒŒë¼ë¯¸í„°

- `message` (í•„ìˆ˜): ì—ëŸ¬ ë©”ì‹œì§€
- `onRetry` (í•„ìˆ˜): ë‹¤ì‹œ ì‹œë„ ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°±
- `title` (ì„ íƒ): ì—ëŸ¬ ì œëª©
- `showBackButton` (ì„ íƒ, ê¸°ë³¸ê°’: false): ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€
- `onBack` (ì„ íƒ): ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°± (showBackButtonì´ trueì¼ ë•Œ í•„ìˆ˜)
- `icon` (ì„ íƒ, ê¸°ë³¸ê°’: Icons.error_outline): ì—ëŸ¬ ì•„ì´ì½˜
- `iconSize` (ì„ íƒ, ê¸°ë³¸ê°’: 64): ì•„ì´ì½˜ í¬ê¸°
- `iconColor` (ì„ íƒ, ê¸°ë³¸ê°’: Colors.red): ì•„ì´ì½˜ ìƒ‰ìƒ

**ì°¸ê³ **: ì œëª©ê³¼ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ì€ í”„ë¡œì íŠ¸ ì „ë°˜ì—ì„œ í†µì¼ëœ ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì œëª©: `TextStyle(fontSize: 20, fontWeight: FontWeight.bold)`
- ë©”ì‹œì§€: `TextStyle(fontSize: 16, color: Colors.red)`

## TextFormField ì‚¬ìš© ê·œì¹™

- í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  TextFormFieldëŠ” `GbTextFormField`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- `TextFormField`ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ë§ê³ , `GbTextFormField` ìœ„ì ¯ì„ ì‚¬ìš©í•˜ì„¸ìš”.
- `GbTextFormField`ëŠ” `lib/common/component/gb_text_form_field.dart`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ê¸°ë³¸ ìŠ¤íƒ€ì¼ (login, product ìŠ¤íƒ€ì¼)
GbTextFormField(
  controller: _emailController,
  labelText: 'ì´ë©”ì¼',
  hintText: 'example@email.com',
  prefixIcon: const Icon(Icons.email_outlined),
  keyboardType: TextInputType.emailAddress,
  validator: (value) {
    if (value == null || value.isEmpty) {
      return 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
    }
    return null;
  },
)

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - Filled ìŠ¤íƒ€ì¼ (signup ìŠ¤íƒ€ì¼)
GbTextFormField(
  controller: _nameController,
  hintText: 'ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”',
  filled: true, // ì´ íŒŒë¼ë¯¸í„°ë¡œ filled ìŠ¤íƒ€ì¼ í™œì„±í™”
  validator: (value) {
    if (value == null || value.isEmpty) {
      return 'ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
    }
    return null;
  },
)

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ë¹„ë°€ë²ˆí˜¸ í•„ë“œ
GbTextFormField(
  controller: _passwordController,
  obscureText: !_isPasswordVisible,
  labelText: 'ë¹„ë°€ë²ˆí˜¸',
  hintText: 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”',
  prefixIcon: const Icon(Icons.lock_outlined),
  suffixIcon: IconButton(
    icon: Icon(_isPasswordVisible ? Icons.visibility : Icons.visibility_off),
    onPressed: () {
      setState(() {
        _isPasswordVisible = !_isPasswordVisible;
      });
    },
  ),
  validator: (value) {
    if (value == null || value.isEmpty) {
      return 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”';
    }
    return null;
  },
)

// âŒ ì˜ëª»ëœ ì‚¬ìš©
TextFormField(
  controller: _emailController,
  decoration: InputDecoration(
    labelText: 'ì´ë©”ì¼',
    border: OutlineInputBorder(),
  ),
)
```

### GbTextFormField íŒŒë¼ë¯¸í„°

- `controller` (ì„ íƒ): TextEditingController
- `labelText` (ì„ íƒ): ë¼ë²¨ í…ìŠ¤íŠ¸
- `hintText` (ì„ íƒ): íŒíŠ¸ í…ìŠ¤íŠ¸
- `prefixIcon` (ì„ íƒ): ì ‘ë‘ì‚¬ ì•„ì´ì½˜
- `suffixIcon` (ì„ íƒ): ì ‘ë¯¸ì‚¬ ì•„ì´ì½˜
- `suffixText` (ì„ íƒ): ì ‘ë¯¸ì‚¬ í…ìŠ¤íŠ¸
- `keyboardType` (ì„ íƒ): í‚¤ë³´ë“œ íƒ€ì…
- `obscureText` (ì„ íƒ, ê¸°ë³¸ê°’: false): ë¹„ë°€ë²ˆí˜¸ ëª¨ë“œ
- `maxLines` (ì„ íƒ, ê¸°ë³¸ê°’: 1): ìµœëŒ€ ë¼ì¸ ìˆ˜
- `validator` (ì„ íƒ): ìœ íš¨ì„± ê²€ì‚¬ í•¨ìˆ˜
- `filled` (ì„ íƒ, ê¸°ë³¸ê°’: false): Filled ìŠ¤íƒ€ì¼ ì‚¬ìš© ì—¬ë¶€ (signup ìŠ¤íƒ€ì¼)
- `decoration` (ì„ íƒ): ì»¤ìŠ¤í…€ InputDecoration (ê¸°ë³¸ ìŠ¤íƒ€ì¼ì„ ë®ì–´ì”€)

**ì°¸ê³ **: 
- `filled: false` (ê¸°ë³¸ê°’): ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì‚¬ìš© (login, product ìŠ¤íƒ€ì¼)
- `filled: true`: Filled ìŠ¤íƒ€ì¼ ì‚¬ìš© (signup ìŠ¤íƒ€ì¼) - ìë™ìœ¼ë¡œ ìƒì„¸í•œ border ìŠ¤íƒ€ì¼ê³¼ contentPadding ì ìš©

## EmptyView ì‚¬ìš© ê·œì¹™

- í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ë¹ˆ ìƒíƒœ í‘œì‹œëŠ” `GbEmptyView`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- ë¹ˆ ìƒíƒœ ì•„ì´ì½˜, ë©”ì‹œì§€ë¥¼ ì§ì ‘ êµ¬ì„±í•˜ì§€ ë§ê³ , `GbEmptyView` ìœ„ì ¯ì„ ì‚¬ìš©í•˜ì„¸ìš”.
- `GbEmptyView`ëŠ” `lib/common/view/gb_empty_view.dart`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì•„ì´ì½˜ê³¼ ë©”ì‹œì§€
const GbEmptyView(
  icon: Icons.search,
  message: 'ìƒí’ˆì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”',
)

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ë©”ì‹œì§€ë§Œ (ì•„ì´ì½˜ ì—†ìŒ)
const GbEmptyView(
  message: 'ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤',
)

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ì»¤ìŠ¤í…€ ì•„ì´ì½˜ ìƒ‰ìƒ
const GbEmptyView(
  icon: Icons.search_off,
  message: 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤',
  iconSize: 64,
  iconColor: Colors.grey,
)

// âŒ ì˜ëª»ëœ ì‚¬ìš©
Center(
  child: Column(
    mainAxisAlignment: MainAxisAlignment.center,
    children: [
      Icon(Icons.search, size: 64, color: Colors.grey.shade300),
      const SizedBox(height: 16),
      Text('ìƒí’ˆì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”'),
    ],
  ),
)
```

### GbEmptyView íŒŒë¼ë¯¸í„°

- `message` (í•„ìˆ˜): ë¹ˆ ìƒíƒœ ë©”ì‹œì§€
- `icon` (ì„ íƒ): ë¹ˆ ìƒíƒœ ì•„ì´ì½˜ (ì—†ìœ¼ë©´ ì•„ì´ì½˜ í‘œì‹œ ì•ˆ í•¨)
- `iconSize` (ì„ íƒ, ê¸°ë³¸ê°’: 64): ì•„ì´ì½˜ í¬ê¸°
- `iconColor` (ì„ íƒ, ê¸°ë³¸ê°’: Colors.grey.shade300): ì•„ì´ì½˜ ìƒ‰ìƒ

**ì°¸ê³ **: ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ì€ í”„ë¡œì íŠ¸ ì „ë°˜ì—ì„œ í†µì¼ëœ ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤ (fontSize: 16, color: Color(0xFF9CA3AF)).

## LoadingView ì‚¬ìš© ê·œì¹™

- í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì „ì²´ í™”ë©´ ë¡œë”© í‘œì‹œëŠ” `GbLoadingView`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
- `Center(child: CircularProgressIndicator())`ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ë§ê³ , `GbLoadingView` ìœ„ì ¯ì„ ì‚¬ìš©í•˜ì„¸ìš”.
- `GbLoadingView`ëŠ” `lib/common/view/gb_loading_view.dart`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ê¸°ë³¸ ë¡œë”© ë·°
const GbLoadingView()

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ë©”ì‹œì§€ê°€ ìˆëŠ” ë¡œë”© ë·°
const GbLoadingView(
  message: 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...',
)

// âŒ ì˜ëª»ëœ ì‚¬ìš©
Center(child: CircularProgressIndicator())
```

### GbLoadingView íŒŒë¼ë¯¸í„°

- `message` (ì„ íƒ): ë¡œë”© ë©”ì‹œì§€ (ì—†ìœ¼ë©´ CircularProgressIndicatorë§Œ í‘œì‹œ)

## State ë¶„ê¸° ì²˜ë¦¬ ë° Build í—¬í¼ ë©”ì„œë“œ ê·œì¹™

### ë¶ˆí•„ìš”í•œ State ë¶„ê¸° ì²˜ë¦¬ ê¸ˆì§€

ê°™ì€ Viewë¥¼ ì‚¬ìš©í•˜ëŠ” ì—¬ëŸ¬ ìƒíƒœëŠ” `||` íŒ¨í„´ìœ¼ë¡œ í†µí•©í•´ì•¼ í•©ë‹ˆë‹¤. ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” í•˜ìœ„ ìƒíƒœë“¤ì€ ë¶€ëª¨ í´ë˜ìŠ¤ë§Œ ë§¤ì¹­í•˜ë©´ ìë™ìœ¼ë¡œ ëª¨ë“  í•˜ìœ„ ìƒíƒœê°€ í¬í•¨ë©ë‹ˆë‹¤.

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - || íŒ¨í„´ìœ¼ë¡œ í†µí•©
switch (state) {
  ProductPaginatedLoaded(:final products, :final pagination, :final sortBy) ||
  ProductPaginatedLoadingMore(:final products, :final pagination, :final sortBy) =>
    HomeLoadedView(
      products: products,
      pagination: pagination,
      sortBy: sortBy,
      isLoadingMore: state is ProductPaginatedLoadingMore,
    ),
}

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ë¶€ëª¨ í´ë˜ìŠ¤ë§Œ ë§¤ì¹­ (í•˜ìœ„ ìƒíƒœ ìë™ í¬í•¨)
switch (state) {
  ProfileLoaded(:final user) =>  // ProfileImageUploading, ProfileUpdating ë“± ëª¨ë“  í•˜ìœ„ ìƒíƒœ í¬í•¨
    ProfileLoadedView(user: user),
  UpdateProductLoaded() =>  // UpdateProductUploading, UpdateProductUpdating ë“± ëª¨ë“  í•˜ìœ„ ìƒíƒœ í¬í•¨
    ProductEditorForm(...),
}

// âŒ ì˜ëª»ëœ ì‚¬ìš© - ì¤‘ë³µëœ ë¶„ê¸° ì²˜ë¦¬
switch (state) {
  ProductPaginatedLoaded(...) => HomeLoadedView(...),
  ProductPaginatedLoadingMore(...) => HomeLoadedView(...),  // ì¤‘ë³µ!
}

// âŒ ì˜ëª»ëœ ì‚¬ìš© - ë¶ˆí•„ìš”í•˜ê²Œ ëª¨ë“  í•˜ìœ„ ìƒíƒœ ë‚˜ì—´
switch (state) {
  ProfileLoaded(:final user) ||
  ProfileImageUploading(:final user) ||
  ProfileImageUploadSuccess(:final user) ||  // ë¶ˆí•„ìš”! ë¶€ëª¨ í´ë˜ìŠ¤ë§Œìœ¼ë¡œ ì¶©ë¶„
  ProfileUpdating(:final user) =>
    ProfileLoadedView(user: user),
}
```

### Build í—¬í¼ ë©”ì„œë“œ ì‚¬ìš© ê¸ˆì§€

`_build` í—¬í¼ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ë§ê³ , ìœ„ì ¯ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

**í•µì‹¬ ì°¨ì´ì :**
- **`_build` í—¬í¼ ë©”ì„œë“œ**: ë§¤ë²ˆ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ìœ„ì ¯ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , `const` ìƒì„±ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ Flutterì˜ ìœ„ì ¯ íŠ¸ë¦¬ ìµœì í™”(Element ì¬ì‚¬ìš©)ë¥¼ ì œëŒ€ë¡œ í™œìš©í•  ìˆ˜ ì—†ìŒ
- **ìœ„ì ¯ í´ë˜ìŠ¤ ì§ì ‘ ì‚¬ìš©**: `const` ìƒì„±ìì™€ `key`ë¥¼ ì‚¬ìš©í•œ ìµœì í™”ê°€ ê°€ëŠ¥í•˜ê³ , Flutterê°€ Elementë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

**StatelessWidgetë„ `_build` í—¬í¼ë¡œ í˜¸ì¶œí•˜ë©´ ê°™ì€ ë¬¸ì œ ë°œìƒ:**
- StatelessWidget ìì²´ëŠ” ë¬¸ì œê°€ ì—†ì§€ë§Œ, `_build` í—¬í¼ ë©”ì„œë“œë¡œ StatelessWidgetì„ ë°˜í™˜í•˜ë©´ ì—¬ì „íˆ ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë¨
- ë”°ë¼ì„œ StatelessWidgetë„ ì§ì ‘ ì‚¬ìš©í•´ì•¼ í•¨

```dart
// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš© - ìœ„ì ¯ í´ë˜ìŠ¤ ì§ì ‘ ì‚¬ìš© (const ê°€ëŠ¥, keyë¡œ ìµœì í™” ê°€ëŠ¥)
switch (state) {
  ProfileLoaded(:final user) =>
    ProfileLoadedView(  // StatelessWidget ì§ì ‘ ì‚¬ìš©
      key: const ValueKey('profile_loaded'),  // keyë¡œ ìµœì í™”
      user: user,
      onLogout: _handleLogout,
      onEditProfile: _handleEditProfile,
    ),
}

// âŒ ì˜ëª»ëœ ì‚¬ìš© - _build í—¬í¼ ë©”ì„œë“œ ì‚¬ìš© (StatelessWidgetì´ì–´ë„ ë¬¸ì œ)
switch (state) {
  ProfileLoaded(:final user) => _buildProfileLoadedView(user),
}

Widget _buildProfileLoadedView(pod.User user) {  // âŒ ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  return ProfileLoadedView(  // StatelessWidgetì´ì–´ë„ _buildë¡œ í˜¸ì¶œí•˜ë©´ ìµœì í™” ë¶ˆê°€
    user: user,
    onLogout: _handleLogout,
    onEditProfile: _handleEditProfile,
  );
}
```

### ì˜ˆì™¸ ì‚¬í•­

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ëŠ” í—ˆìš©ë©ë‹ˆë‹¤:

1. **Switch ë¬¸ì„ í¬í•¨í•˜ëŠ” í—¬í¼ ë©”ì„œë“œ**: `_buildBody`ì²˜ëŸ¼ switch ë¬¸ ìì²´ë¥¼ í¬í•¨í•˜ëŠ” ê²½ìš°
   ```dart
   Widget _buildBody(SearchState state) {
     return switch (state) {  // switch ë¬¸ì„ í¬í•¨í•˜ë¯€ë¡œ í—ˆìš©
       SearchInitial() => const SearchInitialView(),
       SearchLoaded(...) => SearchLoadedView(...),
     };
   }
   ```

2. **ì‘ì€ UI ì¡°ê° í—¬í¼**: `_buildFAQItem`, `_buildInfoItem`, `_buildDivider` ë“± ì‘ì€ UI ì¡°ê°ì„ ë°˜í™˜í•˜ëŠ” ê²½ìš°
   - ë‹¨, ê°€ëŠ¥í•˜ë©´ StatelessWidgetìœ¼ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì„ ê¶Œì¥ (ë” ë‚˜ì€ ìµœì í™”)
   ```dart
   // âœ… ê¶Œì¥ - StatelessWidgetìœ¼ë¡œ ë¶„ë¦¬ (const ê°€ëŠ¥, ìµœì í™” ê°€ëŠ¥)
   class InfoItemWidget extends StatelessWidget {
     final IconData icon;
     final String label;
     
     const InfoItemWidget({
       required this.icon,
       required this.label,
       super.key,
     });
     
     @override
     Widget build(BuildContext context) {
       return ListTile(
         leading: Icon(icon),
         title: Text(label),
       );
     }
   }
   
   // âš ï¸ í—ˆìš©ë˜ì§€ë§Œ ê¶Œì¥í•˜ì§€ ì•ŠìŒ - ì‘ì€ UI ì¡°ê° í—¬í¼
   Widget _buildInfoItem(IconData icon, String label) {
     return ListTile(
       leading: Icon(icon),
       title: Text(label),
     );
   }
   ```

### ìš”ì•½

- âœ… ê°™ì€ Viewë¥¼ ì‚¬ìš©í•˜ëŠ” ìƒíƒœëŠ” `||` íŒ¨í„´ìœ¼ë¡œ í†µí•©
- âœ… ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” í•˜ìœ„ ìƒíƒœëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ë§Œ ë§¤ì¹­
- âœ… ìœ„ì ¯ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì‚¬ìš© (const ìƒì„±ì, keyë¡œ ìµœì í™” ê°€ëŠ¥)
- âŒ `_build` í—¬í¼ ë©”ì„œë“œ ì‚¬ìš© ê¸ˆì§€ (StatelessWidgetì´ì–´ë„ `_build`ë¡œ í˜¸ì¶œí•˜ë©´ ìµœì í™” ë¶ˆê°€)
- âŒ ë¶ˆí•„ìš”í•˜ê²Œ ëª¨ë“  í•˜ìœ„ ìƒíƒœ ë‚˜ì—´ ê¸ˆì§€
- ğŸ’¡ ì‘ì€ UI ì¡°ê°ë„ ê°€ëŠ¥í•˜ë©´ StatelessWidgetìœ¼ë¡œ ë¶„ë¦¬ ê¶Œì¥

## Clean Architecture íŒ¨í„´

í”„ë¡œì íŠ¸ëŠ” **Clean Architecture**ë¥¼ ì—„ê²©í•˜ê²Œ ë”°ë¦…ë‹ˆë‹¤. ëª¨ë“  API í˜¸ì¶œì€ ë‹¤ìŒ ë ˆì´ì–´ êµ¬ì¡°ë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:

### ë ˆì´ì–´ êµ¬ì¡°

```
Presentation (Provider/Notifier)
    â†“
Domain (UseCase)
    â†“
Domain (Repository Interface)
    â†‘
Data (Repository Implementation)
    â†“
Data (DataSource)
```

### 1. Data Layer (ë°ì´í„° ì†ŒìŠ¤)

**ìœ„ì¹˜**: `lib/feature/{feature}/data/`

- **DataSource**: Serverpod Clientë¥¼ ì‚¬ìš©í•œ API í˜¸ì¶œë§Œ ë‹´ë‹¹
  - íŒŒì¼: `datasource/{feature}_remote_datasource.dart`
  - Serverpod Client ì§ì ‘ í˜¸ì¶œ
  - Exceptionì„ throw (Either ì‚¬ìš© ì•ˆ í•¨)

```dart
// âœ… ì˜¬ë°”ë¥¸ DataSource
class ProductRemoteDataSource {
  pod.Client get _client => PodService.instance.client;
  
  Future<pod.Product> getProductDetail(int id) async {
    try {
      return await _client.product.getProduct(id);
    } catch (e) {
      throw Exception('ìƒí’ˆ ìƒì„¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: $e');
    }
  }
}

// âŒ ì˜ëª»ëœ ì‚¬ìš© - UseCaseë‚˜ Repositoryë¥¼ DataSourceì—ì„œ ì§ì ‘ í˜¸ì¶œ
```

- **Repository Implementation**: Domainì˜ Repository ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„
  - íŒŒì¼: `repository/{feature}_repository_impl.dart`
  - DataSourceë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  - Domainì˜ Repository ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

```dart
// âœ… ì˜¬ë°”ë¥¸ Repository Implementation
class ProductRepositoryImpl implements ProductRepository {
  final ProductRemoteDataSource remoteDataSource;
  
  @override
  Future<pod.Product> getProductDetail(int id) async {
    return remoteDataSource.getProductDetail(id);
  }
}
```

### 2. Domain Layer (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

**ìœ„ì¹˜**: `lib/feature/{feature}/domain/`

- **Repository Interface**: ë°ì´í„° ì†ŒìŠ¤ ì¶”ìƒí™”
  - íŒŒì¼: `repository/{feature}_repository.dart`
  - ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì •ì˜
  - ì™¸ë¶€ ì˜ì¡´ì„± ì—†ìŒ (ìˆœìˆ˜ Dart)

```dart
// âœ… ì˜¬ë°”ë¥¸ Repository Interface
abstract class ProductRepository {
  Future<pod.Product> getProductDetail(int id);
  Future<void> deleteProduct(int productId);
}
```

- **UseCase**: ë‹¨ì¼ ì±…ì„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  - íŒŒì¼: `usecase/{action}_{feature}_usecase.dart`
  - Repository ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš© (êµ¬í˜„ì²´ê°€ ì•„ë‹˜)
  - `Either<Failure, T>` íŒ¨í„´ ì‚¬ìš©
  - `UseCase<T, Params, Repo>` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

```dart
// âœ… ì˜¬ë°”ë¥¸ UseCase
class GetProductDetailUseCase
    implements UseCase<pod.Product, int, ProductRepository> {
  final ProductRepository repository;
  
  @override
  Future<Either<Failure, pod.Product>> call(int param) async {
    try {
      final result = await repository.getProductDetail(param);
      return Right(result);
    } on Exception catch (e) {
      return Left(GetProductDetailFailure('ìƒí’ˆì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', exception: e));
    }
  }
}

// âŒ ì˜ëª»ëœ ì‚¬ìš© - DataSourceë¥¼ ì§ì ‘ ì‚¬ìš©
class GetProductDetailUseCase {
  final ProductRemoteDataSource dataSource; // âŒ
}
```

### 3. Presentation Layer (UI)

**ìœ„ì¹˜**: `lib/feature/{feature}/presentation/`

- **Provider/Notifier**: Riverpod ìƒíƒœ ê´€ë¦¬
  - íŒŒì¼: `provider/{feature}_notifier.dart`
  - UseCaseë§Œ ì‚¬ìš© (Repositoryë‚˜ DataSource ì§ì ‘ ì‚¬ìš© ê¸ˆì§€)
  - `StateNotifier` ë˜ëŠ” `Notifier` ì‚¬ìš©

```dart
// âœ… ì˜¬ë°”ë¥¸ Notifier
class ProductDetailNotifier extends StateNotifier<ProductDetailState> {
  final GetProductDetailUseCase getProductDetailUseCase;
  
  Future<void> loadProductDetail(int productId) async {
    final result = await getProductDetailUseCase(productId);
    result.fold(
      (failure) => state = ProductDetailError(failure.message),
      (product) => state = ProductDetailLoaded(product),
    );
  }
}

// âŒ ì˜ëª»ëœ ì‚¬ìš© - Repositoryë‚˜ DataSource ì§ì ‘ ì‚¬ìš©
class ProductDetailNotifier {
  final ProductRepository repository; // âŒ
  final ProductRemoteDataSource dataSource; // âŒ
}
```

### ì˜ì¡´ì„± ê·œì¹™

1. **Presentation â†’ Domain**: Presentationì€ Domain(UseCase)ë§Œ ì˜ì¡´
2. **Data â†’ Domain**: DataëŠ” Domain(Repository Interface)ë¥¼ êµ¬í˜„
3. **Domain â†’ ì™¸ë¶€ ì—†ìŒ**: Domainì€ ì™¸ë¶€ ì˜ì¡´ì„±ì´ ì—†ì–´ì•¼ í•¨
4. **ì§ì ‘ í˜¸ì¶œ ê¸ˆì§€**: 
   - âŒ Presentationì—ì„œ Repositoryë‚˜ DataSource ì§ì ‘ ì‚¬ìš© ê¸ˆì§€
   - âŒ UseCaseì—ì„œ DataSource ì§ì ‘ ì‚¬ìš© ê¸ˆì§€
   - âŒ DataSourceì—ì„œ ë‹¤ë¥¸ DataSourceë‚˜ UseCase ì‚¬ìš© ê¸ˆì§€

### íŒŒì¼ êµ¬ì¡° ì˜ˆì‹œ

```
lib/feature/product/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ datasource/
â”‚   â”‚   â””â”€â”€ product_remote_datasource.dart  # Serverpod Client í˜¸ì¶œ
â”‚   â””â”€â”€ repository/
â”‚       â””â”€â”€ product_repository_impl.dart    # Repository ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ repository/
â”‚   â”‚   â””â”€â”€ product_repository.dart         # Repository ì¸í„°í˜ì´ìŠ¤
â”‚   â””â”€â”€ usecase/
â”‚       â””â”€â”€ get_product_detail_usecase.dart # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â””â”€â”€ presentation/
    â””â”€â”€ provider/
        â””â”€â”€ product_detail_notifier.dart    # UseCase ì‚¬ìš©
```

### Provider ì„¤ì •

ëª¨ë“  ì˜ì¡´ì„±ì€ Riverpod Providerë¡œ ì£¼ì…ë©ë‹ˆë‹¤:

```dart
// âœ… ì˜¬ë°”ë¥¸ Provider êµ¬ì¡°
final productRemoteDataSourceProvider = Provider<ProductRemoteDataSource>((ref) {
  return const ProductRemoteDataSource();
});

final productRepositoryProvider = Provider<ProductRepository>((ref) {
  final remoteDataSource = ref.watch(productRemoteDataSourceProvider);
  return ProductRepositoryImpl(remoteDataSource);
});

final getProductDetailUseCaseProvider = Provider<GetProductDetailUseCase>((ref) {
  final repository = ref.watch(productRepositoryProvider);
  return GetProductDetailUseCase(repository);
});

final productDetailNotifierProvider = StateNotifierProvider<ProductDetailNotifier, ProductDetailState>((ref) {
  final getProductDetailUseCase = ref.watch(getProductDetailUseCaseProvider);
  return ProductDetailNotifier(getProductDetailUseCase);
});
```

### ìš”ì•½

- âœ… **DataSource**: Serverpod Client ì§ì ‘ í˜¸ì¶œ
- âœ… **Repository Implementation**: DataSource ì‚¬ìš©, Domain ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- âœ… **Repository Interface**: Domainì— ì •ì˜, ì¶”ìƒ í´ë˜ìŠ¤
- âœ… **UseCase**: Repository ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©, Either íŒ¨í„´
- âœ… **Notifier**: UseCaseë§Œ ì‚¬ìš©, ìƒíƒœ ê´€ë¦¬
- âŒ **ë ˆì´ì–´ ê±´ë„ˆë›°ê¸° ê¸ˆì§€**: ê° ë ˆì´ì–´ëŠ” ë°”ë¡œ ì•„ë˜ ë ˆì´ì–´ë§Œ ì˜ì¡´
